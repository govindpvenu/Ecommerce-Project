
<main class="main">
    <div class="section block-breadcrumb">
      <div class="container"> 
        <div class="breadcrumbs"> 
          <ul> 
            <li> <a href="#">Home </a></li>
            <li> <a href="#">Cart</a></li>
          </ul>
        </div>
      </div>
    </div>
    <section class="section block-cart">
      <div class="container">
        <div class="row mt-20">
          <div class="col-lg-7">
            <div class="box-title-cart">
              <h4>Your Cart</h4>
              <h6>2 items</h6>
            </div>
            <!-- Cart item -->
            <% var sum = 0%>
            <% for(var i=0;i<userCart.cart.length;i++) { %>
            <div class="list-items-cart">
              <div class="item-cart">
                <div class="item-cart-image"><img src="/images/<%= userCart.cart[i].productId.images[0] %>" alt="Guza"></div>
                <div class="item-cart-info">
                  <div class="item-cart-info-1"><a class="text-16-medium" href="#"><%= userCart.cart[i].productId.title %></a>
                    <div class="box-info-size-color-product">
                      <p class="box-size"><span class="body-p2 neutral-medium-dark">Type:</span><span class="body-p2 neutral-dark"><%= userCart.cart[i].productId.product_type %></span></p>
                      <p class="box-color"><span class="body-p2 neutral-medium-dark">Price:</span><span class="body-p2 neutral-dark">₹<%= userCart.cart[i].productId.sales_price %></span></p>
                    </div>
                    <div class="box-form-cart text-center">
                      <div class="form-cart detail-qty">
                        <a href="#" onclick="changeQuantity('<%=userCart.cart[i].productId._id%>',-1,'<%= userCart.cart[i].productId.sales_price %>','subtot-<%= i %>','cartSubTotal','total','qty-<%= userCart.cart[i].productId._id %>')" >
                          <span class="minus"></span>
                        </a>
                        <span class="qty-val form-control"  type="text" id="qty-<%= userCart.cart[i].productId._id %>"><%= userCart.cart[i].quantity %></span>
                        <a href="#"  onclick="changeQuantity('<%=userCart.cart[i].productId._id%>',1,'<%= userCart.cart[i].productId.sales_price %>','subtot-<%= i %>','cartSubTotal','total','qty-<%= userCart.cart[i].productId._id %>')" >
                          <span class="plus"></span>
                        </a>

                        <!-- <input class="qty-val form-control" type="text" name="quantity" value="1" min="1"> -->
                      </div>
                    </div>
                  </div>
                  <div class="item-cart-info-2">
                    
                    <p>₹</p>
                    <p class="body-p2" id="subtot-<%= i %>"> <%= userCart.cart[i].productId.sales_price * userCart.cart[i].quantity %></p><a class="btn-remove-cart" href="/remove-cart/<%=userCart.cart[i].productId._id%>"></a>
                  </div>
                </div>
              </div>
            </div>
            <% } %>

            <!-- Cart item -->

            <div class="box-coupon">
              <div class="coupon-left">
                <input class="form-control input-coupon" type="text" placeholder="Coupon code">
                <button class="btn btn-border">Apply</button>
              </div>
              <div class="coupon-right"><a class="btn btn-border" href="#">Update Cart</a></div>
            </div>
          </div>
          <div class="col-lg-5">
            <div class="box-detail-cart">
              <h4 class="mb-25">Order Summary</h4>
              <div class="box-info-cart">
                <div class="d-flex align-items-center justify-content-between box-border-bottom">
                  <h5 class="neutral-medium-dark">Subtotal</h5>
                  <h5>₹</h5>
                  <h5 class="neutral-dark" id="grandTotal"><%=grandTotal%></h5>
                </div>
                <div class="box-info-cart-inner">
                  <p class="text-17-medium text-uppercase mb-15">Shipping</p>
                  <div class="list-radio">
                    <div class="item-radio">
                      <label>
                        <input type="radio" name="shipping" checked="checked">Flat rate: $50.00
                      </label><span class="price-ship">$50.00</span>
                    </div>
                    <div class="item-radio">
                      <label>
                        <input type="radio" name="shipping">Local pickup: $60.00
                      </label>
                    </div>
                  </div>
                  <p class="body-p2 neutral-medium-dark mb-12">Shipping options will be updated during checkout.</p><a class="text-17 calculate-shipping" href="#">Calculate shipping</a>
                </div>
                <div class="d-flex align-items-center justify-content-between box-total-bottom">
                  <h5 class="neutral-medium-dark">Total</h5>
                  <h5 class="neutral-dark" id="total">₹ <%= grandTotal %></h5>
                </div>
                <div class="box-button-cart"><a class="btn btn-black" href="/checkout">Proceed To Checkout</a></div>
                <div class="box-other-link"><a class="text-17 link-green" href="#">Free shipping on orders over $200.00</a><a class="text-17" href="#">Continue Shopping</a></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
  <footer class="footer">
    <div class="footer-1">
      <div class="container">
        <div class="row">
          <div class="col-lg-4 mb-30">
            <h5 class="color-white mb-20">Receive an exclusive<span class="tone-red">20%</span><br class="d-none d-md-block">discount code when you<br class="d-none d-md-block">signup.</h5>
            <div class="box-form-subscribe box-form-subscribe-white">
              <form class="form-sub" action="#" method="POST">
                <input class="form-control" type="text" placeholder="Enter your email">
                <input class="btn btn-subscribe" type="submit" value="Subscribe">
              </form>
            </div>
          </div>
          <div class="col-lg-8 mb-30">
            <div class="row">
              <div class="col-lg-3 mb-30 footerBorder">
                <h6 class="color-white mb-20">Company</h6>
                <ul class="menu-footer">
                  <li><a href="about-us-1.html">About us</a></li>
                  <li><a href="carrers.html">Careers</a></li>
                  <li><a href="store-location.html">Store Locator</a></li>
                  <li><a href="contact.html">Contact Us</a></li>
                </ul>
              </div>
              <div class="col-lg-3 mb-30 footerBorder">
                <h6 class="color-white mb-20">Customer Care</h6>
                <ul class="menu-footer">
                  <li><a href="about-us-1.html">Size Guide</a></li>
                  <li><a href="team.html">Help & FAQs</a></li>
                  <li><a href="career.html">Return My Order</a></li>
                  <li><a href="#">Refer a Friend</a></li>
                </ul>
              </div>
              <div class="col-lg-3 mb-30 footerBorder">
                <h6 class="color-white mb-20">Terms & Policies</h6>
                <ul class="menu-footer">
                  <li><a href="#">Duties & Taxes</a></li>
                  <li><a href="#">Shipping Info</a></li>
                  <li><a href="#">Privacy Policy</a></li>
                  <li><a href="#">Terms Conditions</a></li>
                </ul>
              </div>
              <div class="col-lg-3 mb-30 footerBorder">
                <h6 class="color-white mb-20">Follow Us</h6>
                <ul class="menu-footer">
                  <li><a href="#">Instagram</a></li>
                  <li><a href="#">Facebook</a></li>
                  <li><a href="#">Pinterest</a></li>
                  <li><a href="#">Tiktok</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="footer-2">
      <div class="container">
        <div class="footer-bottom">
          <div class="row align-items-center">
            <div class="col-lg-6 col-md-12 text-center text-lg-start mb-20"><img class="mr-25 d-inline-block align-middle logo-footer-img" src="assets/imgs/template/logo-light.svg" alt="Guza"><span class="body-p1 color-white d-inline-block align-middle">© 2023 Guza.Co. All rights reserved</span></div>
            <div class="col-lg-6 col-md-12 text-center text-lg-end mb-20">
              <div class="d-flex justify-content-center justify-content-lg-end align-items-center box-all-payments">
                <div class="d-inline-block box-payments mr-20"><img src="assets/imgs/template/icons/visa.svg" alt="Guza"><img src="assets/imgs/template/icons/master.svg" alt="Guza"><img src="assets/imgs/template/icons/stripe.svg" alt="Guza"><img src="assets/imgs/template/icons/paypal.svg" alt="Guza"></div>
                <div class="dropdown mr-20">
                  <button class="btn btn-line-bottom dropdown-toggle" id="dropdownLang" type="button" data-bs-toggle="dropdown" aria-expanded="false">EN</button>
                  <ul class="dropdown-menu" aria-labelledby="dropdownLang">
                    <li><a class="dropdown-item" href="#">EN</a></li>
                    <li><a class="dropdown-item" href="#">JP</a></li>
                    <li><a class="dropdown-item" href="#">KR</a></li>
                  </ul>
                </div>
                <div class="dropdown">
                  <button class="btn btn-line-bottom dropdown-toggle" id="dropdownCurrency" type="button" data-bs-toggle="dropdown" aria-expanded="false">USD</button>
                  <ul class="dropdown-menu" aria-labelledby="dropdownCurrency">
                    <li><a class="dropdown-item" href="#">USD</a></li>
                    <li><a class="dropdown-item" href="#">EURO</a></li>
                    <li><a class="dropdown-item" href="#">AUD</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <script>
    function changeQuantity(productId,count,price,subTotal,cartSubTotal,total,quantity){
      console.log(productId);
      console.log(count);
      console.log(price);
      console.log(subTotal);
      console.log(cartSubTotal);
      console.log(total);
      console.log(quantity);
        const subtotalValue = document.getElementById(subTotal).innerHTML
        const grandTotalValue = document.getElementById('grandTotal').innerHTML
        const quantityValue = document.getElementById(quantity).innerHTML
        let totalValue = parseInt(subtotalValue)
        console.log('----');
        console.log('subtotalValue:'+subtotalValue);
        console.log(typeof(subtotalValue));
        console.log('grandTotalValue:'+grandTotalValue);
        console.log('quantityValue:'+quantityValue);
        console.log('totalValue:'+totalValue);
        console.log('----');
       
        console.log(quantityValue,count);
        if(quantityValue == 1 && count == -1){
            return;
        }
        console.log('ajax');
        $.ajax({ 
         url:'/change-quantity',
         method: 'post',
         data:{
             productId,
             count
         },
        })
        
        if(count === 1){
            document.getElementById(subTotal).innerHTML = parseInt(price)+totalValue
            document.getElementById('grandTotal').innerHTML = parseInt(price)+parseInt(grandTotalValue);
            document.getElementById('total').innerHTML = parseInt(price)+parseInt(grandTotalValue);
            document.getElementById(quantity).innerHTML = parseInt(quantityValue)+1;
            console.log('+');

        }else if(count === -1){
            document.getElementById(subTotal).innerHTML = totalValue-parseInt(price)
            document.getElementById('grandTotal').innerHTML = parseInt(grandTotalValue)-parseInt(price);
            document.getElementById('total').innerHTML = parseInt(grandTotalValue)-parseInt(price);
            document.getElementById(quantity).innerHTML = parseInt(quantityValue)-1;
            console.log('-');

        }
    
              
    }
  </script>